<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Larryâ€™s Gun Room | Beresford, SD</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body>

<header class="hero">
  <div class="hero-content">
    <h1>Larryâ€™s Gun Room</h1>
    <p>Collecting, Dealing & Trading Since 1969</p>
  </div>
</header>

<hr class="divider">

<section>
  <h2>Business Information</h2>
  <p><strong>GUN ROOM, LLC</strong></p>
  <p>105 North 8th Street<br>Beresford, SD 57004</p>
  <p><strong>Phone:</strong> (605) 763-5090</p>
  <p><strong>Phone Hours:</strong> 8:00 AM â€“ 10:00 PM (CST)</p>
</section>

<section>
  <h2>About Us</h2>
  <p>
    Larryâ€™s Gun Room has been buying, selling, and trading fine firearms since 1969.
    We specialize in collectible Winchesters, antiques, and quality firearms.
  </p>
  <p>
    Satisfaction guaranteed with a 3-day inspection period. All firearms should be
    inspected by a competent gunsmith before firing.
  </p>
</section>

<section>
  <h2>Current Catalog</h2>
  <p>View or download our latest Fall Catalog:</p>
  <a class="button" href="catalog.pdf" target="_blank">
    ðŸ“„ View Fall Catalog (PDF)
  </a>
</section>

<section id="inventory" class="inventory-grid"></section>

<footer>
  <p>Â© Larryâ€™s Gun Room, LLC â€” Beresford, South Dakota</p>
</footer>

<script>
const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQQABes-BmlnfiQ4tB8tWX6Z0MNRv_rhDJjc4qomYnmuCy-xgJdt81dReyVPT7ZGAu5Mclw_sgZDZ_a/pub?gid=0&single=true&output=csv";

fetch(sheetURL)
  .then(res => res.text())
  .then(csv => {
    const rows = csv.trim().split("\n").slice(1);
    const container = document.getElementById("inventory");
    container.innerHTML = "";

    rows.forEach(line => {
      const cols = line.split(",");

      const name   = cols[1];
      const price  = cols[2];
      const status = cols[3];
      const image  = cols[4];
      const slug   = cols[7];

      if (!name || status !== "AVAILABLE") return;

      const url = slug ? `/gun.html?slug=${slug}` : "#";

      const card = document.createElement("a");
      card.href = url;
      card.className = "item-card";

      card.innerHTML = `
        <div class="image-wrapper">
          <img src="${image}" alt="${name}">
        </div>
        <h3>${name}</h3>
        <p class="price">$${price}</p>
      `;

      container.appendChild(card);
    });
  })
  .catch(err => console.error("Inventory CSV error:", err));
</script>
  
</body>
</html>
