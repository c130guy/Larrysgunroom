<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Larryâ€™s Gun Room | Beresford, SD</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">

  <style>
    .item-card.sold {
      opacity: 0.5;
    }
    .sold-ribbon {
      position: absolute;
      top: 10px;
      left: -5px;
      background: #b00020;
      color: white;
      padding: 5px 12px;
      font-weight: bold;
      font-size: 0.85rem;
      transform: rotate(-5deg);
      z-index: 2;
    }
    .image-wrapper {
      position: relative;
    }

    /* Catalog button */
    .catalog-button {
      display: inline-block;
      margin: 30px 0;
      padding: 14px 22px;
      background: #1f2937;
      color: #ffffff;
      text-decoration: none;
      font-size: 1.1rem;
      font-weight: bold;
      border-radius: 6px;
    }
    .catalog-button:hover {
      background: #374151;
    }
  </style>
</head>
<body>

<header class="hero">
  <div class="hero-content">
    <h1>Larryâ€™s Gun Room</h1>
    <p>Collecting, Dealing & Trading Since 1969</p>
  </div>
</header>

<hr class="divider">

<section>
  <h2>Business Information</h2>
  <p><strong>GUN ROOM, LLC</strong></p>
  <p>
    105 North 8th Street<br>
    Beresford, SD 57004
  </p>
  <p><strong>Phone:</strong> (605) 763-5090</p>
  <p><strong>Phone Hours:</strong> 8:00 AM â€“ 10:00 PM (CST)</p>
</section>

<section>
  <h2>About Us</h2>
  <p>
    Larryâ€™s Gun Room has been buying, selling, and trading fine firearms since 1969.
    We specialize in collectible Winchesters, antiques, and quality firearms.
  </p>
</section>

<!-- âœ… CATALOG BUTTON -->
<section>
  <a class="catalog-button" href="/catalog.pdf" target="_blank">
    ðŸ“„ View Full Catalog (PDF)
  </a>
</section>

<!-- INVENTORY -->
<section id="inventory" class="inventory-grid">
  <p>Loading inventoryâ€¦</p>
</section>

<footer>
  <p>Â© Larryâ€™s Gun Room, LLC â€” Beresford, South Dakota</p>
</footer>

<script>
/* ================= CONFIG ================= */

const SHEET_URL =
  "https://docs.google.com/spreadsheets/d/e/2PACX-1vQQABes-BmlnfiQ4tB8tWX6Z0MNRv_rhDJjc4qomYnmuCy-xgJdt81dReyVPT7ZGAu5Mclw_sgZDZ_a/pub?gid=0&single=true&output=csv";

const API_KEY = "AIzaSyBF6oEWQAiqJcKyFfJFUJelQgOldL1ZWQg";

/* =============== DO NOT EDIT BELOW =============== */

fetch(SHEET_URL)
  .then(res => res.text())
  .then(csv => {
    const rows = csv.trim().split("\n").slice(1);
    const container = document.getElementById("inventory");
    container.innerHTML = "";

    rows.forEach(row => {
      const cols = row.split(",").map(c => c.trim().replace(/^"|"$/g, ""));

      const id     = cols[0];
      const name   = cols[1];
      const price  = cols[2];
      const status = (cols[3] || "").toUpperCase();
      const folder = cols[5] || "";

      if (!id || !name) return;

      const card = document.createElement("a");
      card.className = "item-card";
      card.href = `/gun.html?id=${id}`;

      if (status === "SOLD") {
        card.classList.add("sold");
      }

      card.innerHTML = `
        <div class="image-wrapper">
          ${status === "SOLD" ? "<div class='sold-ribbon'>SOLD</div>" : ""}
          <div class="no-image">No Photo</div>
        </div>
        <h3>${name}</h3>
        <p class="price">$${price}</p>
      `;

      container.appendChild(card);

      const match = folder.match(/[-\w]{25,}/);
      if (!match) return;

      fetch(
        `https://www.googleapis.com/drive/v3/files` +
        `?q='${match[0]}' in parents` +
        `&spaces=drive` +
        `&supportsAllDrives=true` +
        `&includeItemsFromAllDrives=true` +
        `&orderBy=name` +
        `&pageSize=1` +
        `&fields=files(id)` +
        `&key=${API_KEY}`
      )
      .then(r => r.json())
      .then(d => {
        if (d.files && d.files.length) {
          card.querySelector(".image-wrapper").innerHTML =
            `${status === "SOLD" ? "<div class='sold-ribbon'>SOLD</div>" : ""}` +
            `<img src="https://drive.google.com/thumbnail?id=${d.files[0].id}&sz=w400">`;
        }
      });
    });
  });
</script>

</body>
</html>








