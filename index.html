<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Larry’s Gun Room | Beresford, SD</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body>

<header class="hero">
  <div class="hero-content">
    <h1>Larry’s Gun Room</h1>
    <p>Collecting, Dealing & Trading Since 1969</p>
  </div>
</header>

<hr class="divider">

<section>
  <h2>Business Information</h2>
  <p><strong>GUN ROOM, LLC</strong></p>
  <p>105 North 8th Street<br>Beresford, SD 57004</p>
  <p><strong>Phone:</strong> (605) 763-5090</p>
  <p><strong>Phone Hours:</strong> 8:00 AM – 10:00 PM (CST)</p>
</section>

<section>
  <h2>About Us</h2>
  <p>
    Larry’s Gun Room has been buying, selling, and trading fine firearms since 1969.
    We specialize in collectible Winchesters, antiques, and quality firearms.
  </p>
</section>

<section id="inventory" class="inventory-grid"></section>

<footer>
  <p>© Larry’s Gun Room, LLC — Beresford, South Dakota</p>
</footer>

<script>
/* ================================
   CONFIG — EDIT API KEY ONLY
   ================================ */

var SHEET_URL =
  "https://docs.google.com/spreadsheets/d/e/2PACX-1vQQABes-BmlnfiQ4tB8tWX6Z0MNRv_rhDJjc4qomYnmuCy-xgJdt81dReyVPT7ZGAu5Mclw_sgZDZ_a/pub?gid=0&single=true&output=csv";

var API_KEY = "AIzaSyBF6oEWQAiqJcKyFfJFUJelQgOldL1ZWQg";

/* ================================
   DO NOT EDIT BELOW THIS LINE
   ================================ */

fetch(SHEET_URL)
  .then(function(res) { return res.text(); })
  .then(function(csv) {

    var rows = csv.trim().split("\n").slice(1).map(function(r) {
      return r.split(",");
    });

    var container = document.getElementById("inventory");
    container.innerHTML = "";

    rows.forEach(function(row) {

      var id     = row[0];
      var name   = row[1];
      var price  = row[2];
      var status = row[3];
      var folderURL = row[5];

      if (!id || !name || status !== "AVAILABLE") return;

      var card = document.createElement("a");
      card.href = "/gun.html?id=" + id;
      card.className = "item-card";

      var imgHTML = "<div class='image-wrapper'><div class='no-image'>No Photo</div></div>";

      if (folderURL) {
        var match = folderURL.match(/[-\w]{25,}/);
        if (match) {
          var folderId = match[0];

          fetch(
            "https://www.googleapis.com/drive/v3/files?q='FOLDER_ID'+in+parents+and+mimeType+contains+'image/'&orderBy=name&pageSize=1&fields=files(id,name)&key=API_KEY
          )
          .then(function(res) { return res.json(); })
          .then(function(data) {
            if (data.files && data.files.length) {
              var fileId = data.files[0].id;
              card.querySelector(".image-wrapper").innerHTML =
                "<img src='https://drive.google.com/thumbnail?id=" +
                fileId +
                "&sz=w400'>";
            }
          });
        }
      }

      card.innerHTML =
        imgHTML +
        "<h3>" + name + "</h3>" +
        "<p class='price'>$" + price + "</p>";

      container.appendChild(card);
    });
  })
  .catch(function() {
    document.getElementById("inventory").innerHTML =
      "<p>Error loading inventory.</p>";
  });
</script>

</body>
</html>

